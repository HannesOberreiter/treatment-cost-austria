Für deine MA Results: 12 Teilnehmer haben mehr als 5 Antworten gegeben, und diese wurden entfernt.
14:09 Uhr
Des sind übrigens auch genau die, die nicht abschließen konnten! ("unvollständige Antwort") (bearbeitet) 

48 haben nur eine Antwort angekreuzt, die lasse ich natürlich drinnen, wäre interessant die auch mal separat auszuwerten!

bei einem n von >1200 wohl die bisher weltweit größte Untersuchung diesbezüglich!
image.png 
image.png


14:17 Uhr
kosten sind weit hinten, Förderung in Österreich unerheblich - kannst gut in deiner Arbeit diskutieren!

Hannes  14:18 Uhr
dh. ich kann gut diskutieren, dass meine Arbeit uninteressant für ImkerInnen ist :zwinkern:

Robert Brodschneider  14:20 Uhr
nene, Kosten spielen für die Imker bei der Wahl der Behandlungsmethode keine Rolle, das ist a) gut so, weil teuer nicht gleich gut ist (bearbeitet) 
14:20 Uhr
b) falsch, weil teuer gut ist!
14:20 Uhr
Zutreffendes basierend auf deiner Endaussage ankreuzen!

Hannes  14:20 Uhr
nice :zwinkern:
Neu

Robert Brodschneider  14:21 Uhr
Die Topp 5 Gründe sind alle sehr sachlich, und können durch haufenweise studien in der Diskussion belegt werden!
14:22 Uhr
Gewohnheit spielt eine erstaunlich kleine Rolle, was zeigt, das Imkereien gewillt sind flexibel zu reagieren
14:23 Uhr
Ein Ö Spezifikum scheint, dass Rückständen soviel mehr Beachtung geschenkt wird als Resistenzen!

Hannes  14:23 Uhr
weißt du ob die Reihenfolge der 5 Gründe wie du sie exportierst, dass “klick” Verhalten widerspiegelt. Also erster Grund wurde als erstes geklickt etc. oder einfach nur von der random Reihenfolge kommt.

Robert Brodschneider  14:24 Uhr
nene, das wäre so nicht möglich, da ja jeder eine andere Reihenfolge gesehen hat, und die Ausgabe in einer einheitlichen Tabelle erfolgt!
14:24 Uhr
deswegen sag ich ja, nur mal die 1-klicker auswerten!

Hannes  14:24 Uhr
jo auf jeden Fall


# Operation Size

One question could be if bigger beekeeping operation spend less or more money on treatment. 

## Mean and Median

To test this we look at the cost distribution between different operation sizes, see fig. \@ref(fig:operation-size). The results indicate a bigger variance in the answers for the smaller hobby beekeepers, which could partly explained by the higher number of answers. The "1-20 Colonies" operations also have overall a higher mean and median cost answers. 

```{r operation-size, include=T, fig.cap="Mean and Median costs per colony in the survey for given Operation Size groups."}

K.SEQ <- c( seq( 0, 100, 20 ), Inf )
K.SEQ2 <- c( seq( 20, 120, 20 ), Inf )

V.LABEL <- paste(K.SEQ, K.SEQ2, sep = "-")
V.LABEL <- V.LABEL[1:6]
V.LABEL[6] <- "> 100"
V.LABEL[1] <- "1-20"

DATA$size_group <- cut( DATA$hives_winter, K.SEQ, labels=V.LABEL, include.lowest = TRUE, right = TRUE )

x <- DATA %>% group_by(size_group) %>% summarise(
  n       = n(),
  sm      = mean(costs),
  upper   = mean(costs)+sd(costs),
  lower   = mean(costs)-sd(costs),
  calc    = "Mean + Standard Deviation"
);

y <- DATA %>% group_by(size_group) %>% summarise(
  n       = n(),
  sm      = median(costs),
  upper   = quantile(costs)[4],
  lower   = quantile(costs)[2],
  calc    = "Median + 1 & 3 Quantile"
);

xy <- rbind(x, y)

ggplot(xy, aes(x = size_group, y = sm, ymin=lower, ymax=upper)) +
  geom_pointrange() + facet_wrap(~calc) +
  geom_text(aes(y=0, label = paste0("n=",n)), size=3) +
  xlab("Operation Size (Number of Colonies)") + ylab("Costs / Colony [Euro]") +
  theme_classic()
  
rm(y, x, K.SEQ, K.SEQ2)
```

## GLM Model

Next we want to check the results statistically with a regression model. To see what family we should use in the glm model, we use qq-plot to check for normality of costs, see \@ref(fig:operation-qq).

```{r operation-qq, include=T, fig.cap="QQ Plots of costs for the given operation size groups."}

ggplot(DATA, aes(sample=costs)) + 
  geom_qq() + geom_qq_line(color="red") + 
  theme_classic() + 
  facet_wrap(
    ~size_group, ncol = 3,
    labeller = labeller(
        size_group = function(x){return(paste(x, "Colonies"))}
      )
    )
```

The qqplots indicating a somewhat normal distribution and the previous shown boxplots, mean and median show a homogenity. 

```{r, indcude=T}
# We use normal parameters, same results as with lm
# ~ 0 to check not between groups
# https://www.researchgate.net/post/R_stats_It_is_possible_to_fix_the_intercept_of_a_GLS_model_with_both_categorical_and_continuous_predictors
# https://stats.stackexchange.com/questions/181113/is-there-any-difference-between-lm-and-glm-for-the-gaussian-family-of-glm
# https://stats.stackexchange.com/questions/190763/how-to-decide-which-glm-family-to-use
# Poisson Info
# http://www.stat.cmu.edu/~brian/463-663/week04/checking-poissonness.pdf
# https://www.theanalysisfactor.com/generalized-linear-models-in-r-part-6-poisson-regression-count-variables/
# lmer package
# file:///Users/btree-mac/Downloads/v82i13.pdf

glm_size_gaussian <- glm(
  costs ~ 0 + size_group, data = DATA, family = gaussian()
  )
sum_size_gaussian <- summary(glm_size_gaussian)
sum_size_gaussian
```


```{r}
# Building Plot

# get CI
ci_size_gaussian  <- confint(glm_size_gaussian)
# Generate Tibble for easier plotting
size_gsm_plot = tibble(
  group = V.LABEL,
  mean = sum_size_gaussian$coefficients[,1],
  lower = ci_size_gaussian[,1],
  upper = ci_size_gaussian[,2]
)
# reorder plot
size_gsm_plot$group <- factor(size_gsm_plot$group, levels = V.LABEL)
# Post-hoc Pairwise
# Familiy-wise error correction, Bonferroni step down (Holm, FWER) 
costs_size_pairwise <- pairwise.t.test(DATA$costs, DATA$size_group, p.adj = c("holm"))
# Extract p-value
costs_size_pairwise <- costs_size_pairwise$p.value
# Generate dataframe for sign. plot
costs_size_pairwise <- 
  as_tibble(costs_size_pairwise) %>% 
  add_column(compare = rownames(costs_size_pairwise)) %>% 
  pivot_longer(., cols = c(1:5)) %>% 
  drop_na(value) %>% 
  filter(value < .05)

costs_size_pairwise$y <- max(size_gsm_plot$upper)+ seq(0.5,nrow(costs_size_pairwise), 1)

```


The resulting CI and pairwise comparison shows significant difference between the smallest group and bigger operation.

```{r operation-ci, include=T, fig.cap="Mean and confidence intervall for given operation size groups. Overall mean (orange line) and significance pairwise results are included."}
# Plot our Regression CI with Pairwise Sign.
ggplot(size_gsm_plot,
  aes(
    y = mean,
    x = group
  )) +
  geom_point() + geom_errorbar(aes(ymin = lower,
                                   ymax = upper)) + 
  theme_classic() + ylab("Costs [Euro]") + xlab("Operation Size [Number Colonies]") +
  #geom_text(aes(x = 3, y = 12.3, label="italic(p) < 0.05"), color = "gray", parse=T) + 
  annotate("text", x = 6, y = 10.3, label=paste("mean =", round(mean(DATA$costs),2)), color = "gray") + 
    geom_text(
      aes(
        x=c(1:6), y = 0, 
        label=paste("n = ", xy$n[1:6])), 
      color = "gray") + 
  geom_hline(yintercept=mean(DATA$costs), color=colorBlindBlack8[2]) +
  theme(
    axis.text.x = element_text(size = 14)
  ) +
  scale_y_continuous(
    limits = c(0,max(size_gsm_plot$upper)*1.3),
    breaks = c(0:round(max(size_gsm_plot$upper)*1.3))
      ) +
  geom_signif(
    data=costs_size_pairwise,
    aes(xmin=name, xmax=compare, annotations="italic(p) < 0.05", y_position = y),
    textsize = 3, vjust = -0.2, color = "gray", manual=TRUE, parse=TRUE)
rm(costs_size_pairwise, size_gsm_plot, sum_size_gaussian, glm_size_gaussian, xy)
```

## Conclusio

A trend can be seen, could be due to some high costs answers from very small beekeepers. Still there is a trend that bigger operations spend less money, but not significant.

# Estimated Economic Costs

## Generate Bootstrap CI

To generate a better estimate we use a confidence interval. The confidence interval is calculated with bootstrap method and 10.000 replicas. With the bootstrap samples we calculate a confidence interval based on Bca.

The Distribution of the bootstrap mean can be seen in fig. \@ref(fig:boot-mean).

```{r}
# Generate Bootstrap Dataset
#boot_median <- boot::boot(DATA$costs, fBootMedian, R=10000)
boot_mean   <- boot::boot(DATA$costs, fBootMean, R=10000)
#ci_median <- boot::boot.ci(boot_median, conf=0.95, type="bca")
ci_mean   <- boot::boot.ci(boot_mean, conf=0.95, type="bca")

fBootPlot <- function(x, t){
  p1 <- ggplot() + 
    geom_histogram(aes(x$t)) +
    geom_vline(xintercept=x$t0, color = colorBlindBlack8[2]) +
    geom_text(
      aes(x= x$t0+0.1, y = 1000, label = paste0(t, ": ", round(x$t0,2))),
      hjust="left",
      color = colorBlindBlack8[2]
      ) +
    theme_classic() + 
    xlab(paste("Cost -",t ,"[Euro]")) + ylab("Count [#]") + 
    ggtitle(paste(t,"- 10.000 Replicas"), subtitle = "Histogramm")
  
  p2 <- ggplot() + aes(sample=x$t) + 
    geom_qq() + geom_qq_line() +
    theme_classic() + ylab("Sample Quantiles (Costs)") + xlab("Theoretical Quantiles") +
    ggtitle("", subtitle = "QQ-Plot")
  
  return(p1 + p2)
}
```

```{r boot-mean, include=T, warning = F, fig.cap="Boostrap Mean"}
p <- fBootPlot(boot_mean, "Mean")
p
```

## Generating Regression CI

Another approach is to use a regression model, to calculate the CI.

```{r}
one.lm <- lm(costs ~ 1, data = DATA)
summary(one.lm)
confint(one.lm)
```


## Estimated Total Values in Austria

Marktwirtschaftlich müsste ich Kosten der Bienenvölker bzw. irgendwie die Volkanzahl * die Kosten



# Treatment

## Mixed Model

Generate Mixed Model to check if factor treatment type is relevant for costs.


# Links

- Science Forum: Ten common statistical mistakes to watch out for when writing or reviewing a manuscript
  - https://elifesciences.org/articles/48175
- What is the difference between fixed effect, random effect and mixed effect models?
  - https://stats.stackexchange.com/questions/4700/what-is-the-difference-between-fixed-effect-random-effect-and-mixed-effect-mode
- Check Your Residual Plots to Ensure Trustworthy Regression Results!
  - https://statisticsbyjim.com/regression/check-residual-plots-regression-analysis/
- ANOVA 
  - http://homepages.inf.ed.ac.uk/bwebb/statistics/ANOVA_in_R.pdf
- Varianzanalyse
  - https://www.beratung-statistik.de/statistik-beratung-infos/r-tutorial/r-varianzanalyse-post-hoc/


